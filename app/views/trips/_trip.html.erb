
<script>
$(function()
{
	$("#<%= trip.id %>").accordion(
	{
		
		collapsible: true
		
		
		
	});
	
	$('.rating_star').click(function() {
		var star = $(this);
		var trip_id = $(this).attr('data-trip-id');
		var stars = $(this).attr('data-stars');
		var myDate = new Date();
		
		
		for(i=1;i<=5;i++){
			if(i<=stars){
			$('#' + trip_id + '_' +i).addClass('on');
		} else {
			$('#' + trip_id + '_' +i).removeClass('on');
		}
	}
	
	
	var data_url = "trip_id="+ $(this).attr('data-trip-id') + "&ratings="+ $(this).attr('data-stars') ;
		$.ajax(
		{
			method: "POST",
			url: "/rating",
			data: data_url
		});
	});
	
	$("#connect_button_<%= trip.id %>:submit").button().click(function(){
	var send_data = "trip_id="+'<%= trip.id %>'
	$.ajax
	({
		url:'/connect',
		data: send_data
		}).done(function(event)
		{
		 alert('You have been successfully added to the trip')
		 $("#connect_button_<%= trip.id %>:submit").attr("disabled","disabled")
		 $("#connect_button_<%= trip.id %>:submit").css("background","grey")
		})
	});
		
		
	 
	$("#<%= trip.id %>").accordion("activate", -1)
    $("#passengers_feed").scrollTop(0);
    $("#drivers_feed").scrollTop(0);
	
	
	
	
})
</script>
<div id = "<%= trip.id %>" class = "text trip">
<div>From: <%= trip.from_string %> to: <%= trip.to_string %></div>
<div>
<div>Depart on <%= trip.date.strftime("%m/%d/%y") %> at <%= trip.time.strftime("%I:%M %p") %> <br\>
  <div>  <%= link_to "Poster", trip_owner_url(:user_uid => trip.owner_id) %></div>
  <div class="rating" id="rating1result0_<%= trip.id %>">
	<% (1..5) .each do |i| %>
	<li class= "rating_star" data-stars= "<%= i %>" data-trip-id= "<%= trip.id %>" id="<%= "#{trip.id}_#{i}" %>"</li>
  <% end %>
 </div>
<button id="connect_button_<%= trip.id %>" class = "ui-button-text ui-widget ui-state-default ui-corner-all ui-button-text-only" > Connect </button>
</div>
</div>

</div>



